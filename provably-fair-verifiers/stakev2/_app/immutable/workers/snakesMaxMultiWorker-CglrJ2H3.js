var G=Object.defineProperty;var P=(_,d,l)=>d in _?G(_,d,{enumerable:!0,configurable:!0,writable:!0,value:l}):_[d]=l;var u=(_,d,l)=>P(_,typeof d!="symbol"?d+"":d,l);(function(){"use strict";function _(r,e=0){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}function d(r,e=new Uint8Array(4),t=0){return e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}function l(r){for(let e=0;e<r.length;e++)r[e]=0;return r}const A=32,k=64;class E{constructor(){u(this,"digestLength",A);u(this,"blockSize",k);u(this,"_state",new Int32Array(8));u(this,"_temp",new Int32Array(64));u(this,"_buffer",new Uint8Array(128));u(this,"_bufferLength",0);u(this,"_bytesHashed",0);u(this,"_finished",!1);this.reset()}_initState(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225}reset(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this}clean(){l(this._buffer),l(this._temp),this.reset()}update(e,t=e.length){if(this._finished)throw new Error("SHA256: can't update because hash was finished.");let i=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[i++],t--;this._bufferLength===this.blockSize&&(w(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(i=w(this._temp,this._state,e,i,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[i++],t--;return this}finish(e){if(!this._finished){const t=this._bytesHashed,i=this._bufferLength,s=t/536870912|0,n=t<<3,h=t%64<56?64:128;this._buffer[i]=128;for(let f=i+1;f<h-8;f++)this._buffer[f]=0;d(s,this._buffer,h-8),d(n,this._buffer,h-4),w(this._temp,this._state,this._buffer,0,h),this._finished=!0}for(let t=0;t<this.digestLength/4;t++)d(this._state[t],e,t*4);return this}digest(){const e=new Uint8Array(this.digestLength);return this.finish(e),e}saveState(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}}restoreState(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this}cleanSavedState(e){l(e.state),e.buffer&&l(e.buffer),e.bufferLength=0,e.bytesHashed=0}}const H=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function w(r,e,t,i,s){for(;s>=64;){let n=e[0],h=e[1],f=e[2],S=e[3],c=e[4],b=e[5],g=e[6],p=e[7];for(let a=0;a<16;a++){let o=i+a*4;r[a]=_(t,o)}for(let a=16;a<64;a++){let o=r[a-2],y=(o>>>17|o<<15)^(o>>>19|o<<13)^o>>>10;o=r[a-15];let B=(o>>>7|o<<25)^(o>>>18|o<<14)^o>>>3;r[a]=(y+r[a-7]|0)+(B+r[a-16]|0)}for(let a=0;a<64;a++){let o=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&b^~c&g)|0)+(p+(H[a]+r[a]|0)|0)|0,y=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&h^n&f^h&f)|0;p=g,g=b,b=c,c=S+o|0,S=f,f=h,h=n,n=o+y|0}e[0]+=n,e[1]+=h,e[2]+=f,e[3]+=S,e[4]+=c,e[5]+=b,e[6]+=g,e[7]+=p,i+=64,s-=64}return i}function x(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}class I{constructor(e,t){u(this,"blockSize");u(this,"digestLength");u(this,"_inner");u(this,"_outer");u(this,"_finished",!1);u(this,"_innerKeyedState");u(this,"_outerKeyedState");this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;const i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(let s=0;s<i.length;s++)i[s]^=54;this._inner.update(i);for(let s=0;s<i.length;s++)i[s]^=106;this._outer.update(i),x(this._inner)&&x(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),l(i)}reset(){if(!x(this._inner)||!x(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this}clean(){x(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),x(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()}update(e){return this._inner.update(e),this}finish(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)}digest(){const e=new Uint8Array(this.digestLength);return this.finish(e),e}saveState(){if(!x(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()}restoreState(e){if(!x(this._inner)||!x(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this}cleanSavedState(e){if(!x(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)}}function z(r,e,t){const i=new I(r,e);i.update(t);const s=i.digest();return i.clean(),s}const m="utf8: invalid string";function L(r){const e=new Uint8Array(K(r));let t=0;for(let i=0;i<r.length;i++){let s=r.charCodeAt(i);s>=55296&&s<=56319&&(s=(s-55296<<10)+(r.charCodeAt(++i)-56320)+65536),s<128?e[t++]=s:s<2048?(e[t++]=192|s>>6,e[t++]=128|s&63):s<65536?(e[t++]=224|s>>12,e[t++]=128|s>>6&63,e[t++]=128|s&63):(e[t++]=240|s>>18,e[t++]=128|s>>12&63,e[t++]=128|s>>6&63,e[t++]=128|s&63)}return e}function K(r){let e=0;for(let t=0;t<r.length;t++){let i=r.charCodeAt(t);if(i>=55296&&i<=56319){if(t===r.length-1)throw new Error(m);t++;const s=r.charCodeAt(t);if(s<56320||s>57343)throw new Error(m);i=(i-55296<<10)+(s-56320)+65536}i<128?e+=1:i<2048?e+=2:i<65536?e+=3:e+=4}return e}function*U(r){const{serverSeed:e,clientSeed:t,nonce:i,cursor:s=0}=r;if(s%4!==0)throw new Error("Cursor must be a multiple of 4");let n=Math.floor(s/32),h=s;for(h-=n*32;;){const f=z(E,L(e),L(`${t}:${i}:${n}`));for(;h<32;)yield Number(f[h]),h+=1;h=0,n+=1}}function*C(r){const{serverSeed:e,clientSeed:t,nonce:i,cursor:s=0}=r,n=U({serverSeed:e,clientSeed:t,nonce:i,cursor:s});for(;;){let h=0;for(let f=0;f<4;f++)h+=n.next().value/256**(f+1);yield h}}self.addEventListener("message",r=>{const{id:e,startIndex:t,endIndex:i,searchParams:s}=r.data;try{let n=0;const{clientSeed:h,serverSeed:f}=s;for(let c=t;c<i;c++){if(n++,M(h,f,c)){const b={taskId:e,found:!0,result:c,processedCount:n};self.postMessage(b);return}n%1e4===0&&setTimeout(()=>{},0)}const S={taskId:e,found:!1,processedCount:n};self.postMessage(S)}catch(n){const h={taskId:e,found:!1,processedCount:0,error:n instanceof Error?n.message:"Unknown error"};self.postMessage(h)}});function M(r,e,t){try{const i=C({clientSeed:r,serverSeed:e,nonce:t});for(let s=0;s<5;s++){const n=s%2===0?1:6;for(let h=0;h<2;h++)if(Math.floor(i.next().value*6)+1!==n)return!1}return!0}catch(i){return console.error("Error in checkSnakePattern:",i),!1}}})();
